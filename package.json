{
  "name": "trilium",
  "description": "development scripts and dependencies",
  "private": true,
  "scripts": {
    "prepare": "husky install",
    "init": "terraform init",
    "stage": "terraform workspace select",
    "key:generate": "ssh-keygen -t rsa -m PEM -f kp-$(jq -r '.name' package.json)-app-$(terraform workspace show).pem -N '' -C '' && chmod 400 kp-$(jq -r '.name' package.json)-app-$(terraform workspace show).pem",
    "download:private-key": "aws s3 cp s3://tf-common-backend/env:/$(terraform workspace show)/$(jq -r '.name' package.json)/kp-$(jq -r '.name' package.json)-app-$(terraform workspace show).pem .",
    "upload:private-key": "aws s3 cp kp-$(jq -r '.name' package.json)-app-$(terraform workspace show).pem s3://tf-common-backend/env:/$(terraform workspace show)/$(jq -r '.name' package.json)/kp-$(jq -r '.name' package.json)-app-$(terraform workspace show).pem",
    "download:tfvars": "aws s3 cp s3://tf-common-backend/env:/$(terraform workspace show)/$(jq -r '.name' package.json)/terraform.tfvars .",
    "upload:tfvars": "aws s3 cp terraform.tfvars s3://tf-common-backend/env:/$(terraform workspace show)/$(jq -r '.name' package.json)/terraform.tfvars",
    "output:json": "terraform output -json > output.json",
    "lint": "terraform fmt -check -diff -recursive",
    "lint:fix": "terraform fmt -recursive",
    "connect": "ssh -i kp-$(jq -r '.name' package.json)-app-$(terraform workspace show).pem $(jq -r '.app_instance_username.value' output.json)@$(jq -r '.app_instance_public_ip.value' output.json)",
    "restart:app": "yarn connect sudo docker restart $(jq -r '.app_container_name_prefix.value' output.json)1",
    "download:db": "scp -i kp-$(jq -r '.name' package.json)-app-$(terraform workspace show).pem $(jq -r '.app_instance_username.value' output.json)@$(jq -r '.app_instance_public_ip.value' output.json):$(jq -r '.data_volume_mount_path.value' output.json)/document.db .",
    "upload:db": "scp -i kp-$(jq -r '.name' package.json)-app-$(terraform workspace show).pem document.db $(jq -r '.app_instance_username.value' output.json)@$(jq -r '.app_instance_public_ip.value' output.json):$(jq -r '.data_volume_mount_path.value' output.json)/document.db",
    "tf-docs": "terraform-docs . -c .terraform-docs.yml"
  },
  "devDependencies": {
    "husky": "^8.0.1"
  }
}
